TODO for Cline.

- [x] Refactor Threads.php
    - [x] Split out file operations into ThreadFileOperations.php
    - [x] Split out utility functions into ThreadUtils.php
    - [x] Split out email services into ThreadEmailService.php
- [ ] Rig for testing
    - [x] Search for file operations and make the path configurable
    - [ ] Basic unit tests for thread functionality
        - [x] Test ThreadFileOperations.php
            - [x] Test getThreads() function
            - [x] Test getThreadFile() function
            - [x] Test getThreadsForEntity() function
        - [ ] Test ThreadUtils.php
            - [ ] Test getThreadId() function
                - [ ] Test UTF-8 string normalization
                - [ ] Test space replacement
                - [ ] Test forward slash replacement
            - [ ] Test getLabelType() function
                - [ ] Test all status types (info, disabled, danger, success, unknown)
                - [ ] Test error case for invalid status type
        - [x] Test ThreadEmailService.php
            - [x] Test email sending success/failure
            - [x] Test email data validation
            - [x] Test error handling
            - [x] Test debug output
    - [ ] update-imap.php
        - [ ] Restructure into multiple files to make it testable
        - [ ] Add unit tests for IMAP operations
        - [ ] Add integration tests with test IMAP server
    - [ ] Setup development IMAP server
        - [ ] Docker container for IMAP server
        - [ ] Configuration for test environment
        - [ ] Test data setup scripts
    - [ ] End-to-end testing
        - [ ] Test email flow from SMTP to IMAP
        - [ ] Test thread creation and updates
        - [ ] Test attachment handling
- [ ] GUI for reading threads
    - [ ] Thread list view
    - [ ] Thread detail view
    - [ ] Email composition interface
    - [ ] Attachment handling UI
- [ ] GUI for replying to threads
    - [ ] Reply form with rich text editor
    - [ ] Template system for common responses
    - [ ] Attachment upload functionality

TODO - medium term:
- [ ] Automatic follow up
    - [ ] Scheduled email sending system
    - [ ] Response tracking
    - [ ] Automated reminder system
    - [ ] Configurable follow-up rules
