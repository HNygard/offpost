TODO for Cline.

- [x] End-to-end testing
    - [x] Test email flow from SMTP to IMAP
    - [x] Test thread creation 
    - [x] Test thread updates
    - [x] Test attachment handling
- [x] Setup development IMAP server
    - [x] Docker container for IMAP server
    - [x] Configuration for test environment
    - [x] Test data setup scripts
- [x] Setup of production
    - [x] Domain setup
    - [x] Cloudflare setup
    - [x] Rsync to server or server auto pulling from Github?
        - Auto pull from server.
    - [x] Prod authentication setup
    - [x] Setup scripts and cron job
    - [x] Start server
    - [x] Copy over the existing data
    - [x] Migrate data to new format (script)
- [x] Apache webroot is not being used. The webroot/index.php is not used. Instead the organizer/src/index.php is used.
- [x] Database driver missing from docker image. Not installed or missing rebuild??
- [x] Is access to thread checked in file.php?


Goal: make production usable


- [ ] Add history table including who did what
    - [ ] Special users for "system". Must point to some usage. Then handled in display.
    - [x] History table for emails
        Example actions
        - [x] Email received
        - [x] Email classified by user (include status type, status text, answer)
        - [x] Email classified by prompt (auto classification)
        - [x] Email sent
        - [X] Email ignored
- [ ] Old threads
    - [x] Remove extra labels
    - [ ] Open some labels to public
    - [ ] Clean up old threads by archiving them
- [ ] Check if we have index in database, if not add
- [ ] Update-imap - Run on schedule
- [ ] Email - Switch ID to UUID

- [ ] Common list of entities

- [ ] Views available for public
    - [ ] Public threads visible to non authenticated users
    - [ ] Front page with information

- [ ] Update-imap - folder creation should be done in class so that logic is the same in tests and update-imap.php
- [ ] GUI for replying to threads
    - [ ] Reply form with rich text editor
    - [ ] Template system for common responses
    - [ ] Attachment upload functionality
- [ ] New thread concepts
    - Reply to thread
    - Enable notiication for replies
    - Automatic follow up

- [ ] Automatic testing of rendering av PHP pages by using PHPUnit tests that sends basic requests to the backend.
    - [x] Start with one test and start a framework for making tests
    - [x] Add e2e-tests to github actions run
    - [x] Add e2e-tests to .clinerules
    - [ ] Stucture e2e-tests
        - [ ] Refactor to use a common class for setup
        - [ ] Refactor to one test file per page
        - [ ] Test that all pages are accessible


 Something to automatically test that the GUIs work
    - [ ] End-to-end testing framework
        - Selenium
        - Cypress
        - Playwright
        - Puppeteer
        - etc.
    - Maybe just do some requests from PHP?
        - Get a token
        - Access all pages
        - Get some data from DB to get thread ids
        - Assert: 200 OK on all requests
        - Need to run as github action
        - Need to be very quick



TODO - medium term:
- [ ] Automatic follow up
    - [ ] Scheduled email sending system
    - [ ] Response tracking
    - [ ] Automated reminder system
    - [ ] Configurable follow-up rules
