TODO for Cline.

- [x] Refactor Threads.php
    - [x] Split out file operations into ThreadFileOperations.php
    - [x] Split out utility functions into ThreadUtils.php
    - [x] Split out email services into ThreadEmailService.php
- [x] Rewrite auth service to automatic create tokens since it's only for development
    - Goal: Opening http://localhost:25081/ should work. It should redirect to login and then back. Verify that tokens are used.
    - [x] Look into the auth service to figure out tasks.
- [x] Separate docker compose config prod and dev
- [x] End to end testing
    - [x] Add SMTP and IMAP server to docker compose development
- [ ] Rig for testing
    - [ ] update-imap.php
        - [x] Add integration tests with test IMAP server
        - [ ] Split update-imap into testable things
- [ ] Setup development IMAP server
    - [x] Docker container for IMAP server
    - [x] Configuration for test environment
    - [ ] Test data setup scripts
- [ ] End-to-end testing
    - [x] Test email flow from SMTP to IMAP
    - [x] Test thread creation 
    - [ ] Test thread updates
    - [ ] Test attachment handling
- [ ] GUI for reading threads
    - [ ] Thread list view
    - [ ] Thread detail view
    - [ ] Email composition interface
    - [ ] Attachment handling UI
- [ ] GUI for replying to threads
    - [ ] Reply form with rich text editor
    - [ ] Template system for common responses
    - [ ] Attachment upload functionality

TODO - medium term:
- [ ] Automatic follow up
    - [ ] Scheduled email sending system
    - [ ] Response tracking
    - [ ] Automated reminder system
    - [ ] Configurable follow-up rules
